<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YEBANA - Inscription</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="logo">
            <i class="fas fa-futbol"></i>
            <h1><a href="index.php" style="text-decoration:none;color:#cc0000;">YEBANA</a></h1>
        </div>
        <p>Rejoignez le réseau professionnel du football en Afrique.</p>

        <form action="#" method="POST" class="registration-form" id="registration-form">
            <div class="form-group">
                <label><i class="fas fa-user-tag"></i> Vous êtes :</label>
                <div class="role-selection">
                    <input type="radio" id="player" name="role" value="player" onclick="location.href='signup.php'">
                    <label for="player">
                        <i class="fas fa-running"></i> Joueur
                    </label>

                    <input type="radio" id="manager" name="role" value="manager">
                    <label for="manager">
                        <i class="fas fa-briefcase"></i> Manager
                    </label>

                    <input type="radio" id="recruiter" name="role" value="recruiter">
                    <label for="recruiter">
                        <i class="fas fa-search-dollar"></i> Recruteur / Club
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label for="email"><i class="fas fa-envelope"></i> Email :</label>
                <input type="email" id="email" name="email" placeholder="votre.email@example.com" required>
            </div>

            <div class="form-group">
                <label for="password"><i class="fas fa-lock"></i> Mot de passe :</label>
                <input type="password" id="password" name="password" placeholder="Minimum 6 caractères" required>
            </div>

            <div class="form-group">
                <label for="full_name"><i class="fas fa-user"></i> Nom :</label>
                <input type="text" id="full_name" name="name" placeholder="Votre nom " required>
            </div>

            <div class="form-group">
                <label for="full_name"><i class="fas fa-user"></i> Prenom :</label>
                <input type="text" id="full_name" name="prenom" placeholder="Votre prénom" required>
            </div>

            <div class="form-group">
                <label for="phone_number"><i class="fas fa-phone"></i> Numéro de Téléphone :</label>
                <input type="tel" id="phone_number" name="phone_number" placeholder="+243 999 999 999" required>
            </div>

            <div id="message-patience" style="display: none; color: green; margin-top: 10px;">Veuillez patienter, connexion en cours...</div>
            <div id="message-erreur" style="display: none; color: red; margin-top: 10px;"></div>
            <div id="message-succes" style="display: none; color: green; margin-top: 10px;">Connexion établie avec succès !</div>

            <button type="submit">
                <i class="fas fa-user-plus"></i> S'inscrire
            </button>
        </form>

        <div class="login-link">
            Déjà un compte ? <a href="login.php">Connectez-vous ici</a>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const registrationForm = document.getElementById('registration-form');
            const messagePatience = document.getElementById('message-patience');
            const messageErreur = document.getElementById('message-erreur');
            const messageSucces = document.getElementById('message-succes');

            // 4. Gestion de la soumission du formulaire
            registrationForm.addEventListener('submit', (event) => {

                event.preventDefault(); // Empêche l'envoi par défaut du formulaire

                messagePatience.style.display = 'block'; 

                const formData = new FormData(registrationForm);

                fetch('register.php', {
                    method: 'POST',
                    body: formData,
                })
                .then(response => response.text()) // Récupère la réponse en tant que texte
                .then(data => {
                    messagePatience.style.display = 'none'; // Cache le message de patience
                    if (data === 'success') {
                        messageSucces.style.display = 'block'; // Affiche le message de succès
                        registrationForm.reset(); // Réinitialise le formulaire
                        // Optionnel : On pourrait recharger la liste des produits ici si on voulait un affichage immédiat
                        setTimeout(() => {
                            messageSucces.style.display = 'none';
                            window.location.href = "login.php";
                    }, 1500); // Cache le message de succès après 3 secondes
                    } else {
                        messageErreur.textContent = 'Erreur lors de la connexion : ' + data;
                        messageErreur.style.display = 'block'; // Affiche le message d'erreur
                        setTimeout(() => {
                            messageErreur.style.display = 'none';
                        }, 2000);
                    }
                })
                .catch(error => {
                    messagePatience.style.display = 'none'; // Cache le message de patience
                    messageErreur.textContent = 'Erreur réseau : ' + error;
                    messageErreur.style.display = 'block'; // Affiche le message d'erreur en cas d'erreur réseau
                });
            });
        });
    </script>
</body>
</html>